import React, { useState } from 'react';

export default function ImageGallery({ images, onDelete }) {
 const [pendingDelete, setPendingDelete] = useState(null);

 if (!images || images.length ===0) {
 return (
 <div className="bg-white p-8 rounded-lg shadow-sm text-center empty-state">
 <p className="text-gray-500">No images to display.</p>
 </div>
 );
 }

 const handleRequestDelete = (id) => {
 setPendingDelete(id);
 };

 const handleConfirmDelete = async () => {
 if (pendingDelete && onDelete) {
 await onDelete(pendingDelete);
 }
 setPendingDelete(null);
 };

 const handleCancelDelete = () => setPendingDelete(null);

 return (
 <>
 <div className="gallery">
 {images.map((img) => (
 <div key={img.id} className="bg-white rounded-lg shadow-sm overflow-hidden">
 <div className="card-image">
 <img src={img.url} alt={img.name} />
 </div>
 <div className="card-meta">
 <h3 className="card-title">{img.name}</h3>
 <p className="card-sub">{img.day}/{img.month}/{img.year}</p>
 {img.timestamp && (
 <p className="card-sub" style={{ marginTop: '4px', fontSize: '0.8rem' }}>{new Date(img.timestamp).toLocaleString()}</p>
 )}
 <div style={{ marginTop: '8px', display: 'flex', gap: '8px' }}>
 {onDelete && (
 <button
 onClick={() => handleRequestDelete(img.id)}
 className="btn"
 style={{ background: '#ef4444' }}
 >
 Delete
 </button>
 )}
 </div>
 </div>
 </div>
 ))}
 </div>

 {/* Confirmation modal */}
 {pendingDelete && (
 <div className="modal-overlay" role="dialog" aria-modal="true">
 <div className="modal-card">
 <h3 style={{ margin:0, marginBottom: '8px' }}>Confirm delete</h3>
 <p style={{ margin:0, marginBottom: '12px' }}>Are you sure you want to delete this image?</p>
 <div style={{ display: 'flex', gap: '8px', justifyContent: 'flex-end' }}>
 <button onClick={handleCancelDelete} className="btn" style={{ background: '#9ca3af' }}>Cancel</button>
 <button onClick={handleConfirmDelete} className="btn" style={{ background: '#ef4444' }}>Delete</button>
 </div>
 </div>
 </div>
 )}
 </>
 );
}
